import{d as ae,u as se}from"./vue-router-0b23dc16.js";import{bO as oe,aF as ne,cb as le,aO as L,b6 as ce,by as ie,cc as re,bA as g}from"./auth-0313e5d1.js";import{b as ue,c as P,r as de}from"./photo-6b81e8a6.js";import{u as pe}from"./static-bddd7a0c.js";import{h as _e,r as p,J as me,o as fe,v as b,x as n,a3 as i,j as l,l as h,C as T,k as _,F as x,D as c,B as m,u as r,X as q,A,ba as ve,b9 as he}from"./runtime-core.esm-bundler-185e3605.js";import{_ as ye}from"./_plugin-vue_export-helper-c27b6911.js";const ge=k=>(ve("data-v-86f3c14d"),k=k(),he(),k),be={class:"flex_r_b"},ke={style:{"font-weight":"600",color:"#606266"}},xe={class:"flex_r_b mt-[5px]"},Ce=ge(()=>h("div",null,null,-1)),we={key:0},ze={key:1},Ne={class:"album-upload"},Se=_e({__name:"index",setup(k){const U=pe().photoTab,C=ae(),F=se(),f=p([]),N=p(0),t=me({current:1,size:50,status:1,id:null}),w=p(null),y=p(!1),j=e=>{t.size=e,u()},D=e=>{t.current=e,u()},E=()=>{y.value=!0},O=()=>{F.push({path:"/photo/addPhotos",query:{id:t.id,albumName:w.value}})},R=()=>{y.value=!1},z=p(!1),S=p([]),V=p(0),G=e=>{V.value=e,z.value=!0},H=()=>{z.value=!1},u=async()=>{const e=await ue(t);if(e.code==0){const{list:a,total:o}=e.result;f.value=a.map(v=>({id:v.id,url:v.url,checked:!1})),S.value=a.map(v=>v.url),N.value=o}},J=e=>{t.status=e.index?Number(e.index)+1:null,u()},B=async()=>{const e=f.value.filter(o=>o.checked);if(!e.length){g("请选择需要删除的图片",{type:"warning"});return}(await P({type:t.status,imgList:e.map(o=>({id:o.id,url:o.url}))})).code==0&&(g("删除成功",{type:"success"}),y.value=!1,u())},M=async()=>{const e=f.value.filter(o=>o.checked);if(!e.length){g("请选择需要恢复的图片",{type:"warning"});return}(await de({idList:e.map(o=>o.id)})).code==0&&(g("恢复成功",{type:"success"}),u())},X=async()=>{(await P({type:t.status,imgList:f.value.map(a=>({id:a.id,url:a.url}))})).code==0&&(g("清空回收站成功",{type:"success"}),u())};return fe(async()=>{if(C.query.id&&C.query.albumName){const{id:e,albumName:a}=C.query;w.value=a,t.id=Number(oe(e))}await u()}),(e,a)=>{const o=i("el-tooltip"),v=i("el-tab-pane"),$=i("el-tabs"),d=i("el-button"),K=i("el-empty"),Q=i("el-checkbox"),W=i("el-image"),Y=i("el-pagination"),Z=i("el-image-viewer"),ee=i("el-card");return l(),b(ee,{class:"album"},{header:n(()=>[h("div",be,[h("span",ke,"图库名称 - "+T(w.value),1)]),h("div",xe,[Ce,t.status==1?(l(),_("div",we,[y.value?(l(),_(x,{key:1},[c(d,{type:"danger",size:"small",icon:r(L),onClick:B},{default:n(()=>[m("批量删除")]),_:1},8,["icon"]),c(d,{type:"info",size:"small",icon:r(L),onClick:R},{default:n(()=>[m("取消")]),_:1},8,["icon"])],64)):(l(),_(x,{key:0},[c(d,{type:"primary",size:"small",icon:r(ne),onClick:O},{default:n(()=>[m("新增")]),_:1},8,["icon"]),c(d,{type:"success",size:"small",icon:r(le),onClick:E},{default:n(()=>[m("编辑")]),_:1},8,["icon"])],64))])):(l(),_("div",ze,[c(d,{type:"danger",size:"small",icon:r(ce),onClick:B},{default:n(()=>[m("批量删除")]),_:1},8,["icon"]),c(d,{type:"success",size:"small",icon:r(ie),onClick:M},{default:n(()=>[m("批量恢复")]),_:1},8,["icon"]),c(d,{type:"info",size:"small",icon:r(re),onClick:X},{default:n(()=>[m("清空")]),_:1},8,["icon"])]))])]),default:n(()=>[c($,{onTabClick:J},{default:n(()=>[(l(!0),_(x,null,q(r(U),s=>(l(),b(v,{key:s.key,lazy:!0},{label:n(()=>[c(o,{content:s.content,placement:"top-end"},{default:n(()=>[h("span",null,T(s.title),1)]),_:2},1032,["content"])]),_:2},1024))),128))]),_:1}),h("div",Ne,[f.value.length?(l(!0),_(x,{key:1},q(f.value,(s,te)=>(l(),_("div",{class:"retrieve-box",key:s.id},[y.value&&t.status==1||t.status==2?(l(),b(Q,{key:0,class:"retrieve-box__checkbox",modelValue:s.checked,"onUpdate:modelValue":I=>s.checked=I},null,8,["modelValue","onUpdate:modelValue"])):A("",!0),c(W,{class:"retrieve-box__img",fit:"cover","data-src":s.url,src:s.url,onClick:I=>G(te)},null,8,["data-src","src","onClick"])]))),128)):(l(),b(K,{key:0}))]),c(Y,{class:"pagination","current-page":t.current,"onUpdate:current-page":a[0]||(a[0]=s=>t.current=s),"page-size":t.size,"onUpdate:page-size":a[1]||(a[1]=s=>t.size=s),"page-sizes":[50,100,200,999],small:!0,disabled:!1,background:!1,layout:"total, sizes, prev, pager, next, jumper",total:N.value,onSizeChange:j,onCurrentChange:D},null,8,["current-page","page-size","total"]),z.value?(l(),b(Z,{key:0,"url-list":S.value,"initial-index":V.value,onClose:H},null,8,["url-list","initial-index"])):A("",!0)]),_:1})}}});const qe=ye(Se,[["__scopeId","data-v-86f3c14d"]]);export{qe as default};
