import{u as ue}from"./vue-router-0b23dc16.js";import{u as de,r as pe,i as me,d as _e,g as fe}from"./article-b2ad0ed5.js";import{g as ge}from"./category-4a372d42.js";import{g as be}from"./tag-229ab50b.js";import{bA as A}from"./auth-0313e5d1.js";import{J as T,r as v,o as ye,D as a,a3 as n,f as he,h as Ce,v as k,x as o,j as _,u as e,e as ve,B as d,k as E,X as G,F as H,C as J,A as X,l as Q}from"./runtime-core.esm-bundler-185e3605.js";import{u as b}from"./hooks-e73aa1dd.js";import{u as ke}from"./static-bddd7a0c.js";import{d as Ve}from"./search-cc37b371.js";import{d as ze}from"./refresh-04c5340d.js";import{d as Ae}from"./delete-2f3d40d2.js";import{d as K}from"./edit-pen-37b5ced2.js";import{d as xe}from"./circle-plus-a2aad0eb.js";import"./index-6d140db2.js";function $e(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!he(y)}function Se(){const y=ue(),p=T({current:1,size:10,article_title:null,tag_id:null,category_id:null,is_top:null,status:null,create_time:null}),r=T({...p}),C=v([]),V=v([]),x=v([]),$=v([]),f=v(!1),B=v("small"),D=[{label:"序号",type:"index",width:55},{label:"文章标题",prop:"article_title",minWidth:130},{label:"文章描述",prop:"article_description",minWidth:130},{label:"分类",prop:"category",cellRenderer:({row:l})=>a(n("el-tag"),null,{default:()=>[l.categoryName]})},{label:"标签",prop:"tagNameList",minWidth:220,cellRenderer:({row:l})=>l.tagNameList.map(i=>a(n("el-tag"),{style:"margin-left: 3px;"},$e(i)?i:{default:()=>[i]}))},{label:"封面",prop:"article_cover",width:200,slot:"image"},{label:"是否置顶",prop:"is_top",slot:"isTop"},{label:"状态",prop:"status",minWidth:80,cellRenderer:({row:l})=>a("span",null,[l.status==1?"公开":l.status==2?"私密":"草稿箱"])},{label:"类型",prop:"type",minWidth:80,cellRenderer:({row:l})=>a("span",null,[l.type===1?"原创":l.type===2?"转载":"私密"])},{label:"发布日期",prop:"createdAt"},{label:"修改日期",prop:"updatedAt"},{label:"操作",fixed:"right",width:180,slot:"operation"}],S=T({pageSize:10,currentPage:1,pageSizes:[10,15,20],total:0,align:"right",background:!0,small:!0}),L=T({text:"正在加载第一页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `}),M=l=>{p.status=l.index?Number(l.index):null,u()};function I(){u()}const N=()=>{Object.assign(p,r),u()};async function O(l){if(l){const{id:i,is_top:m}=l;(await de(i,m)).code==0&&A(`${m==1?"置顶":"取消置顶"} 成功`,{type:"success"})}}async function U(l,i){l&&((await pe(l)).code==0&&A(`恢复文章 ${i}成功`,{type:"success"}),u())}async function P(l,i){(await me(l,i)).code==0&&A(`${i==1?"隐藏":"公开"} 文章成功`,{type:"success"}),u()}function R(l){p.size=l,u()}function W(l){typeof l=="number"&&(L.text=`正在加载第${l}页...`,p.current=l,u())}function j(l){y.push({path:"/article/editArticle",query:{articleId:l.id}})}function Z(){y.push({path:"/article/addArticle"})}async function Y(l,i,m){(await _e(l,i)).code==0&&(i==3?A(`删除文章 ${m}成功`,{type:"success"}):A(`文章 ${m}已进入回收站`,{type:"success"}),u())}async function u(){f.value=!0;const l=await fe(p);l.code==0&&(V.value=l.result.list,S.total=l.result.total,C.value=[],C.value=V.value.map(i=>i.article_cover)),f.value=!1}async function c(){const l=await be();l.code==0&&($.value=l.result)}async function z(){const l=await ge();l.code==0&&(x.value=l.result)}return ye(async()=>{await u(),await z(),await c()}),{param:p,loading:f,columns:D,tableData:V,tableImageList:C,tableSize:B,pagination:S,loadingConfig:L,tagOptionList:$,categoryOptionList:x,tabChange:M,resetParam:N,onSearch:I,onSizeChange:R,onCurrentChange:W,editArticle:j,addArticle:Z,deleteArticleById:Y,changeTop:O,revertArticleById:U,changeArticlePublic:P}}const Le={width:1024,height:1024,body:'<path fill="currentColor" d="M876.8 156.8c0-9.6-3.2-16-9.6-22.4c-6.4-6.4-12.8-9.6-22.4-9.6c-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8c-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4c0 9.6 3.2 16 9.6 22.4c6.4 6.4 12.8 9.6 22.4 9.6c9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8c28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8c0-44.8 16-83.2 48-112c32-28.8 67.2-48 112-48c28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6c-28.8 48-80 105.6-153.6 172.8c-73.6 67.2-172.8 108.8-284.8 115.2c-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8c160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"/><path fill="currentColor" d="M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2c64 0 115.2-22.4 160-64c41.6-41.6 64-96 64-160c0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4c0 44.8-16 83.2-48 112c-32 28.8-67.2 48-112 48Z"/>'},we={width:1024,height:1024,body:'<path fill="currentColor" d="M512 160c320 0 512 352 512 352S832 864 512 864S0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288c52.608 79.872 211.456 288 436.8 288c225.28 0 384.128-208.064 436.8-288c-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448a224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160s-71.744-160-160-160z"/>'},Te=Q("div",{class:"card-header"},"文章管理",-1),qe=Ce({__name:"index",setup(y){const p=ke().articleTab,{param:r,loading:C,columns:V,tableData:x,tableImageList:$,tableSize:f,pagination:B,loadingConfig:D,tagOptionList:S,categoryOptionList:L,tabChange:M,resetParam:I,onSearch:N,onSizeChange:O,onCurrentChange:U,editArticle:P,addArticle:R,deleteArticleById:W,changeTop:j,revertArticleById:Z,changeArticlePublic:Y}=Se();return(u,c)=>{const z=n("el-radio-button"),l=n("el-radio-group"),i=n("el-space"),m=n("el-input"),g=n("el-form-item"),w=n("el-option"),F=n("el-select"),ee=n("el-date-picker"),h=n("el-button"),te=n("el-form"),le=n("el-tooltip"),ae=n("el-tab-pane"),oe=n("el-tabs"),ne=n("el-image"),ie=n("el-switch"),q=n("el-popconfirm"),ce=n("pure-table"),re=n("el-card");return _(),k(re,{shadow:"never"},{header:o(()=>[Te]),default:o(()=>[a(i,{class:"float-right mb-4"},{default:o(()=>[a(l,{modelValue:e(f),"onUpdate:modelValue":c[0]||(c[0]=t=>ve(f)?f.value=t:null),size:"small"},{default:o(()=>[a(z,{label:"large"},{default:o(()=>[d("大")]),_:1}),a(z,{label:"default"},{default:o(()=>[d("中")]),_:1}),a(z,{label:"small"},{default:o(()=>[d("小")]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(te,{inline:!0,class:"bg-bg_color"},{default:o(()=>[a(g,{label:"文章标题："},{default:o(()=>[a(m,{modelValue:e(r).article_title,"onUpdate:modelValue":c[1]||(c[1]=t=>e(r).article_title=t),placeholder:"请输入文章标题",clearable:""},null,8,["modelValue"])]),_:1}),a(g,{label:"文章分类："},{default:o(()=>[a(F,{modelValue:e(r).category_id,"onUpdate:modelValue":c[2]||(c[2]=t=>e(r).category_id=t),placeholder:"请选择文章分类",clearable:"",class:"!w-[160px]"},{default:o(()=>[(_(!0),E(H,null,G(e(L),(t,s)=>(_(),k(w,{key:s,label:t.category_name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"文章标签：",prop:"status"},{default:o(()=>[a(F,{modelValue:e(r).tag_id,"onUpdate:modelValue":c[3]||(c[3]=t=>e(r).tag_id=t),placeholder:"请选择文章标签",clearable:"",class:"!w-[160px]"},{default:o(()=>[(_(!0),E(H,null,G(e(S),(t,s)=>(_(),k(w,{key:s,label:t.tag_name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"是否置顶："},{default:o(()=>[a(F,{modelValue:e(r).is_top,"onUpdate:modelValue":c[4]||(c[4]=t=>e(r).is_top=t),placeholder:"请选择是否置顶",clearable:"",class:"!w-[160px]"},{default:o(()=>[a(w,{label:"是",value:"1"}),a(w,{label:"否",value:"2"})]),_:1},8,["modelValue"])]),_:1}),a(g,{label:"发布时间："},{default:o(()=>[a(ee,{modelValue:e(r).create_time,"onUpdate:modelValue":c[5]||(c[5]=t=>e(r).create_time=t),type:"daterange",placeholder:"请选择发布时间段","range-separator":"到","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(g,null,{default:o(()=>[a(h,{type:"primary",icon:e(b)(e(Ve)),loading:e(C),onClick:e(N)},{default:o(()=>[d(" 搜索 ")]),_:1},8,["icon","loading","onClick"]),a(h,{icon:e(b)(e(ze)),onClick:e(I)},{default:o(()=>[d(" 重置 ")]),_:1},8,["icon","onClick"])]),_:1})]),_:1}),a(i,null,{default:o(()=>[a(h,{type:"primary",size:"small",icon:e(b)(e(xe)),onClick:e(R)},{default:o(()=>[d("新增")]),_:1},8,["icon","onClick"])]),_:1}),a(oe,{onTabClick:e(M)},{default:o(()=>[(_(!0),E(H,null,G(e(p),t=>(_(),k(ae,{key:t.key,lazy:!0},{label:o(()=>[a(le,{content:t.content,placement:"top-end"},{default:o(()=>[Q("span",null,J(t.title),1)]),_:2},1032,["content"])]),_:2},1024))),128))]),_:1},8,["onTabClick"]),a(ce,{border:"","row-key":"id",alignWhole:"center",showOverflowTooltip:"",size:e(f),loading:e(C),"loading-config":e(D),data:e(x),columns:e(V),pagination:e(B),onSizeChange:e(O),onCurrentChange:e(U)},{image:o(({row:t,index:s})=>[a(ne,{"preview-teleported":"",loading:"lazy",src:t.article_cover,"preview-src-list":e($).map(se=>se),"initial-index":s,fit:"cover",class:"w-[160px] h-[80px]"},null,8,["src","preview-src-list","initial-index"])]),isTop:o(({row:t})=>[a(ie,{modelValue:t.is_top,"onUpdate:modelValue":s=>t.is_top=s,"active-value":1,"inactive-value":2,onChange:s=>e(j)(t)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),operation:o(({row:t})=>[a(h,{class:"reset-margin",link:"",type:"primary",size:"small",onClick:s=>e(P)(t),icon:e(b)(e(K))},{default:o(()=>[d(" 修改 ")]),_:2},1032,["onClick","icon"]),[1,2].includes(Number(t.status))?(_(),k(q,{key:0,title:`确认 ${t.status==1?"隐藏":"公开"}文章?`,"icon-color":"#66b1ff",onConfirm:s=>e(Y)(t.id,t.status)},{reference:o(()=>[a(h,{class:"reset-margin",link:"",type:"success",size:"small",icon:t.status==1?e(b)(e(Le)):e(b)(e(we))},{default:o(()=>[d(J(t.status==1?"隐藏":"公开"),1)]),_:2},1032,["icon"])]),_:2},1032,["title","onConfirm"])):X("",!0),a(q,{title:`确认删除文章${t.article_title}?`,"icon-color":"#66b1ff",onConfirm:s=>e(W)(t.id,t.status,t.article_title)},{reference:o(()=>[a(h,{class:"reset-margin",link:"",type:"danger",size:"small",icon:e(b)(e(Ae))},{default:o(()=>[d(" 删除 ")]),_:1},8,["icon"])]),_:2},1032,["title","onConfirm"]),t.status==3?(_(),k(q,{key:1,title:`确认恢复文章${t.article_title}?`,"icon-color":"#66b1ff",onConfirm:s=>e(Z)(t.id,t.article_title)},{reference:o(()=>[a(h,{class:"reset-margin",link:"",type:"success",size:"small",icon:e(b)(e(K))},{default:o(()=>[d(" 恢复 ")]),_:1},8,["icon"])]),_:2},1032,["title","onConfirm"])):X("",!0)]),_:1},8,["size","loading","loading-config","data","columns","pagination","onSizeChange","onCurrentChange"])]),_:1})}}});export{qe as default};
