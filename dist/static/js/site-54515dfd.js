import{d as B,c as j,i as _,u as F}from"./site-c95c3361.js";import{bA as S}from"./auth-0313e5d1.js";import{E as z}from"./index-3c2da9f0.js";import{r as E,J as R,o as D,h as O,v as g,x as n,u as t,a3 as w,j as f,D as o,l as I,B as k,k as L,C as h}from"./runtime-core.esm-bundler-185e3605.js";import{U as m}from"./upload-9e7cdaea.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./vue-router-0b23dc16.js";function N(){const C=E(!1),c=R({}),e=R({id:1,blog_name:"",blog_avatar:"",avatarList:[],avatar_bg:"",bgList:[],personal_say:"",blog_notice:"",qq_link:"",qqCoverList:[],we_chat_link:"",weChatCoverList:[],we_chat_group:"",weChatGroupList:[],qq_group:"",qqGroupList:[],we_chat_pay:"",weChatPayGroupList:[],ali_pay:"",aliPayGroupList:[],github_link:"",git_ee_link:"",bilibili_link:""}),q=R({blog_name:[{required:!0,message:"请输入博客名称",trigger:"blur"}],blog_avatar:{required:!0,validator:(d,r,i)=>{e.avatarList.length?e.bgList.length?i():i(new Error("请上传博客头像背景")):i(new Error("请上传博客头像"))},trigger:"blur"},git_ee_link:{required:!0,message:"请输入码云链接",trigger:"blur"}}),p=E(!1);async function G(d,r){await r.validate(async i=>{if(i)switch(d){case"site":await a(),p.value=!1;break;default:return}})}function V(d){switch(d){case"site":p.value=!0;break;default:return}}function x(d,r){switch(r.clearValidate(),d){case"site":p.value=!1,r.clearValidate(),Object.assign(e,c),Object.assign(c,B(e));break;default:return}}async function U(){const d=await j();if(d.code==0&&d.result){const{blog_avatar:r,avatar_bg:i,we_chat_link:u,qq_link:v,we_chat_group:b,qq_group:y,we_chat_pay:s,ali_pay:P}=d.result;Object.assign(e,d.result),r&&(e.avatarList=[{id:1,name:r.split("/").pop()||"未知名称",url:r}]),i&&(e.bgList=[{id:2,name:i.split("/").pop()||"未知名称",url:i}]),u&&(e.weChatCoverList=[{id:3,name:u.split("/").pop()||"未知名称",url:u}]),v&&(e.qqCoverList=[{id:4,name:v.split("/").pop()||"未知名称",url:v}]),b&&(e.weChatGroupList=[{id:5,name:b.split("/").pop()||"未知名称",url:b}]),y&&(e.qqGroupList=[{id:6,name:y.split("/").pop()||"未知名称",url:y}]),s&&(e.weChatPayGroupList=[{id:7,name:s.split("/").pop()||"未知名称",url:s}]),P&&(e.aliPayGroupList=[{id:8,name:P.split("/").pop()||"未知名称",url:P}]),Object.assign(c,B(e))}}async function a(){C.value=!0;const d=z.service({fullscreen:!0,text:"图片上传中......"});if(e.bgList.length&&!e.bgList[0].id){const i=await _(e.bgList[0]);if(i.code==0){const{url:u}=i.result;e.avatar_bg=u}}if(e.avatarList.length&&!e.avatarList[0].id){const i=await _(e.avatarList[0]);if(i.code==0){const{url:u}=i.result;e.blog_avatar=u}}if(e.qqCoverList.length&&!e.qqCoverList[0].id){const i=await _(e.qqCoverList[0]);if(i.code==0){const{url:u}=i.result;e.qq_link=u}}else e.qqCoverList.length==0&&(e.qq_link="");if(e.weChatCoverList.length&&!e.weChatCoverList[0].id){const i=await _(e.weChatCoverList[0]);if(i.code==0){const{url:u}=i.result;e.we_chat_link=u}}else e.weChatCoverList.length==0&&(e.we_chat_link="");if(e.weChatGroupList.length&&!e.weChatGroupList[0].id){const i=await _(e.weChatGroupList[0]);if(i.code==0){const{url:u}=i.result;e.we_chat_group=u}}else e.weChatGroupList.length==0&&(e.we_chat_group="");if(e.qqGroupList.length&&!e.qqGroupList[0].id){const i=await _(e.qqGroupList[0]);if(i.code==0){const{url:u}=i.result;e.qq_group=u}}else e.qqGroupList.length==0&&(e.qq_group="");if(e.weChatPayGroupList.length&&!e.weChatPayGroupList[0].id){const i=await _(e.weChatPayGroupList[0]);if(i.code==0){const{url:u}=i.result;e.we_chat_pay=u}}else e.weChatPayGroupList.length==0&&(e.we_chat_pay="");if(e.aliPayGroupList.length&&!e.aliPayGroupList[0].id){const i=await _(e.aliPayGroupList[0]);if(i.code==0){const{url:u}=i.result;e.ali_pay=u}}else e.aliPayGroupList.length==0&&(e.ali_pay="");d.close(),(await F(e)).code==0&&(S("网站设置修改成功",{type:"success"}),U()),C.value=!1}return D(()=>{U()}),{loading:C,siteInfoForm:e,siteInfoRules:q,isEditSiteInfo:p,edit:V,save:G,cancel:x}}const $={class:"header"},J={key:0},M={class:"bg-upload"},T={class:"avatar-upload"},H={key:1},K={key:1},Q={key:1},W={key:1},X={key:1},Y={key:1},Z=O({__name:"site",setup(C){const c=E(),{loading:e,siteInfoForm:l,siteInfoRules:q,isEditSiteInfo:p,edit:G,save:V,cancel:x}=N();return(U,a)=>{const d=w("el-button"),r=w("el-form-item"),i=w("el-input"),u=w("el-card"),v=w("el-col"),b=w("el-row"),y=w("el-form");return f(),g(y,{"label-width":"80",ref_key:"siteInfoFormRef",ref:c,model:t(l),rules:t(q)},{default:n(()=>[o(b,{gutter:10},{default:n(()=>[o(v,{sm:24,md:12},{default:n(()=>[o(u,{class:"site-card"},{header:n(()=>[I("div",$,[k(" 博客信息管理 "),t(p)?(f(),L("div",J,[o(d,{type:"info",plain:"",onClick:a[0]||(a[0]=s=>t(x)("site",c.value))},{default:n(()=>[k("取消")]),_:1}),o(d,{plain:"",type:"danger",disabled:t(e),loading:t(e),onClick:a[1]||(a[1]=s=>t(V)("site",c.value))},{default:n(()=>[k("保存")]),_:1},8,["disabled","loading"])])):(f(),g(d,{key:1,type:"primary",plain:"",onClick:a[2]||(a[2]=s=>t(G)("site"))},{default:n(()=>[k("编辑")]),_:1}))])]),default:n(()=>[o(r,{class:"avatar-form",prop:"blog_avatar"},{default:n(()=>[I("div",M,[o(m,{fileList:t(l).bgList,"onUpdate:fileList":a[3]||(a[3]=s=>t(l).bgList=s),limit:1,preview:!t(p),width:300,height:140},null,8,["fileList","preview"])]),I("div",T,[o(m,{fileList:t(l).avatarList,"onUpdate:fileList":a[4]||(a[4]=s=>t(l).avatarList=s),limit:1,preview:!t(p),width:60,height:60},null,8,["fileList","preview"])])]),_:1}),o(r,{label:"博客名称",prop:"blog_name"},{default:n(()=>[t(p)?(f(),g(i,{key:0,modelValue:t(l).blog_name,"onUpdate:modelValue":a[5]||(a[5]=s=>t(l).blog_name=s),clearable:"",placeholder:"请输入博客名称",maxlength:"20"},null,8,["modelValue"])):(f(),L("span",H,h(t(l).blog_name),1))]),_:1}),o(r,{label:"个性签名",prop:"personal_say"},{default:n(()=>[t(p)?(f(),g(i,{key:0,type:"textarea",modelValue:t(l).personal_say,"onUpdate:modelValue":a[6]||(a[6]=s=>t(l).personal_say=s),clearable:"",placeholder:"请输入个性签名",maxlength:"225",resize:"none",autosize:{minRows:2,maxRows:4},"show-word-limit":""},null,8,["modelValue"])):(f(),L("span",K,h(t(l).personal_say||"暂无个签"),1))]),_:1}),o(r,{label:"码云",prop:"git_ee_link"},{default:n(()=>[t(p)?(f(),g(i,{key:0,modelValue:t(l).git_ee_link,"onUpdate:modelValue":a[7]||(a[7]=s=>t(l).git_ee_link=s),placeholder:"请输入gitee链接",clearable:"",maxlength:"225"},null,8,["modelValue"])):(f(),L("span",Q,h(t(l).git_ee_link||"暂无gitee"),1))]),_:1}),o(r,{label:"B站"},{default:n(()=>[t(p)?(f(),g(i,{key:0,modelValue:t(l).bilibili_link,"onUpdate:modelValue":a[8]||(a[8]=s=>t(l).bilibili_link=s),placeholder:"请输入bilibili链接",clearable:"",maxlength:"225"},null,8,["modelValue"])):(f(),L("span",W,h(t(l).bilibili_link||"暂无bilibili"),1))]),_:1}),o(r,{label:"github"},{default:n(()=>[t(p)?(f(),g(i,{key:0,modelValue:t(l).github_link,"onUpdate:modelValue":a[9]||(a[9]=s=>t(l).github_link=s),placeholder:"请输入github链接",clearable:"",maxlength:"225"},null,8,["modelValue"])):(f(),L("span",X,h(t(l).github_link||"暂无github"),1))]),_:1})]),_:1})]),_:1}),o(v,{sm:24,md:12},{default:n(()=>[o(u,{class:"site-card site-card2"},{default:n(()=>[o(r,{class:"link-cover",label:"企鹅"},{default:n(()=>[o(m,{fileList:t(l).qqCoverList,"onUpdate:fileList":a[10]||(a[10]=s=>t(l).qqCoverList=s),width:80,height:80,preview:!t(p),limit:1},null,8,["fileList","preview"])]),_:1}),o(r,{class:"link-cover",label:"微信"},{default:n(()=>[o(m,{fileList:t(l).weChatCoverList,"onUpdate:fileList":a[11]||(a[11]=s=>t(l).weChatCoverList=s),width:80,height:80,preview:!t(p),limit:1},null,8,["fileList","preview"])]),_:1}),o(r,{class:"link-cover",label:"企鹅群组"},{default:n(()=>[o(m,{fileList:t(l).qqGroupList,"onUpdate:fileList":a[12]||(a[12]=s=>t(l).qqGroupList=s),width:80,height:80,preview:!t(p),limit:1},null,8,["fileList","preview"])]),_:1}),o(r,{class:"link-cover",label:"微信群组"},{default:n(()=>[o(m,{fileList:t(l).weChatGroupList,"onUpdate:fileList":a[13]||(a[13]=s=>t(l).weChatGroupList=s),width:80,height:80,preview:!t(p),limit:1},null,8,["fileList","preview"])]),_:1}),o(r,{class:"link-cover",label:"绿宝宝"},{default:n(()=>[o(m,{fileList:t(l).weChatPayGroupList,"onUpdate:fileList":a[14]||(a[14]=s=>t(l).weChatPayGroupList=s),width:80,height:80,preview:!t(p),limit:1},null,8,["fileList","preview"])]),_:1}),o(r,{class:"link-cover",label:"蓝宝宝"},{default:n(()=>[o(m,{fileList:t(l).aliPayGroupList,"onUpdate:fileList":a[15]||(a[15]=s=>t(l).aliPayGroupList=s),width:80,height:80,preview:!t(p),limit:1},null,8,["fileList","preview"])]),_:1}),o(r,{label:"博客公告"},{default:n(()=>[t(p)?(f(),g(i,{key:0,type:"textarea",modelValue:t(l).blog_notice,"onUpdate:modelValue":a[16]||(a[16]=s=>t(l).blog_notice=s),placeholder:"请输入博客公告",maxlength:"225",resize:"none",autosize:{minRows:2,maxRows:4},"show-word-limit":""},null,8,["modelValue"])):(f(),L("span",Y,h(t(l).blog_notice||"暂无公告"),1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])}}});const re=A(Z,[["__scopeId","data-v-2ef8391a"]]);export{re as default};
