import{bA as $}from"./auth-0313e5d1.js";import{d as T,e as X,a as Y,b as Z}from"./category-4a372d42.js";import{J as _,r as y,o as E,h as ee,v as ae,x as t,a3 as c,j as te,D as o,u as e,e as W,B as d,ba as oe,b9 as ne,l as le}from"./runtime-core.esm-bundler-185e3605.js";import{u as k}from"./hooks-e73aa1dd.js";import{d as ie}from"./search-cc37b371.js";import{d as se}from"./refresh-04c5340d.js";import{d as q}from"./delete-2f3d40d2.js";import{d as re}from"./edit-pen-37b5ced2.js";import{d as ce}from"./circle-plus-a2aad0eb.js";import{_ as de}from"./_plugin-vue_export-helper-c27b6911.js";import"./vue-router-0b23dc16.js";import"./index-6d140db2.js";function ue(){const s=_({current:1,size:10,category_name:""}),L=_({...s}),p=y(!1),f=y([]),b=y(!1),w=y("small"),C=y([]),B=[{type:"selection",align:"left",width:30},{label:"序号",type:"index",width:55},{label:"分类",prop:"category_name",minWidth:130},{label:"创建日期",prop:"createdAt"},{label:"修改日期",prop:"updatedAt"},{label:"操作",fixed:"right",width:120,slot:"operation"}],r=_({id:"",category_name:""}),g=_({...r}),F=_({category_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}),x=_({pageSize:10,currentPage:1,pageSizes:[10,15,20],total:0,align:"right",background:!0,small:!0}),h=_({text:"正在加载第1页...",viewBox:"-10, -10, 50, 50",spinner:`
        <path class="path" d="
          M 30 15
          L 28 17
          M 25.61 25.61
          A 15 15, 0, 0, 1, 15 30
          A 15 15, 0, 1, 1, 27.99 7.5
          L 15 15
        " style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>
      `});function z(){l()}const I=()=>{Object.assign(s,L),z()},S=a=>{a&&a.resetFields()};function j(a){C.value=a}function R(a){x.small=a}function A(a){s.size=a,l()}async function V(a){typeof a=="number"&&(h.text=`正在加载第${a}页...`,s.current=a,b.value=!0,l())}async function O(a){p.value=!0,a&&Object.assign(r,a)}async function P(a){(await T({categoryIdList:[a.id]})).code==0&&($(`删除分类${a.category_name}成功`,{type:"success"}),l())}async function U(){if(C.value.length){const a=C.value.map(u=>u.id);(await T({categoryIdList:a})).code==0&&($("批量删除分类成功",{type:"success"}),l())}else $("请先选择分类",{type:"warning"})}function M(){Object.assign(r,g),p.value=!1}async function n(a){a&&await a.validate(async v=>{if(v){let u;r.id?u=await X(r):u=await Y(r),u.code==0&&($(`${r.id?"修改":"新增"}成功`,{type:"success"}),p.value=!1,S(a),Object.assign(r,g),l())}})}async function l(){const a=await Z(s);a.code==0&&(f.value=a.result.list,x.total=a.result.total),b.value=!1}return E(()=>{l()}),{form:r,rules:F,param:s,loading:b,columns:B,dataList:f,tableSize:w,pagination:x,loadingConfig:h,dialogVisible:p,closeDialog:M,submitForm:n,onSearch:z,resetParam:I,resetForm:S,onChange:R,onSizeChange:A,onCurrentChange:V,updateCategory:O,deleteCategory:P,deleteBatch:U,handleSelectionChange:j,getPageCategoryList:l}}const me=s=>(oe("data-v-fe5e338d"),s=s(),ne(),s),pe=me(()=>le("div",{class:"card-header"},"分类管理",-1)),fe=ee({__name:"index",setup(s){const L=y(),p=y(),{form:f,rules:b,param:w,loading:C,columns:B,dataList:r,tableSize:g,pagination:F,loadingConfig:x,dialogVisible:h,closeDialog:z,submitForm:I,onSearch:S,resetParam:j,onSizeChange:R,onCurrentChange:A,updateCategory:V,deleteCategory:O,deleteBatch:P,handleSelectionChange:U}=ue();return(M,n)=>{const l=c("el-radio-button"),a=c("el-radio-group"),v=c("el-space"),u=c("el-input"),D=c("el-form-item"),m=c("el-button"),N=c("el-form"),J=c("el-popconfirm"),G=c("pure-table"),H=c("el-dialog"),K=c("el-card");return te(),ae(K,{shadow:"never",class:"card"},{header:t(()=>[pe]),default:t(()=>[o(v,{class:"float-right mb-4"},{default:t(()=>[o(a,{modelValue:e(g),"onUpdate:modelValue":n[0]||(n[0]=i=>W(g)?g.value=i:null),size:"small"},{default:t(()=>[o(l,{label:"large"},{default:t(()=>[d("大")]),_:1}),o(l,{label:"default"},{default:t(()=>[d("中")]),_:1}),o(l,{label:"small"},{default:t(()=>[d("小")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(N,{ref_key:"formRef",ref:L,inline:!0,model:e(w),class:"bg-bg_color w-[99/100]"},{default:t(()=>[o(D,{label:"分类名称：",prop:"username"},{default:t(()=>[o(u,{modelValue:e(w).category_name,"onUpdate:modelValue":n[1]||(n[1]=i=>e(w).category_name=i),placeholder:"请输入分类名称",clearable:"",class:"!w-[160px]"},null,8,["modelValue"])]),_:1}),o(D,null,{default:t(()=>[o(m,{type:"primary",icon:e(k)(e(ie)),loading:e(C),onClick:e(S)},{default:t(()=>[d(" 搜索 ")]),_:1},8,["icon","loading","onClick"]),o(m,{icon:e(k)(e(se)),onClick:e(j)},{default:t(()=>[d(" 重置 ")]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["model"]),o(v,{class:"mb-4 w-[100%] flex justify-between items-center"},{default:t(()=>[o(m,{type:"danger",size:"small",icon:e(k)(e(q)),onClick:e(P)},{default:t(()=>[d("批量删除")]),_:1},8,["icon","onClick"]),o(m,{class:"reset-margin",type:"primary",size:"small",icon:e(k)(e(ce)),onClick:e(V)},{default:t(()=>[d("新增")]),_:1},8,["icon","onClick"])]),_:1}),o(G,{border:"","row-key":"id",alignWhole:"center",showOverflowTooltip:"",size:e(g),loading:e(C),"loading-config":e(x),height:"calc(100vh - 360px)",data:e(r),columns:e(B),pagination:e(F),onSizeChange:e(R),onCurrentChange:e(A),onSelectionChange:e(U)},{operation:t(({row:i})=>[o(m,{class:"reset-margin",link:"",type:"primary",size:"small",onClick:Q=>e(V)(i),icon:e(k)(e(re))},{default:t(()=>[d(" 修改 ")]),_:2},1032,["onClick","icon"]),o(J,{title:`删除分类${i.category_name}?`,"icon-color":"#66b1ff",onConfirm:Q=>e(O)(i)},{reference:t(()=>[o(m,{class:"reset-margin",link:"",type:"danger",size:"small",icon:e(k)(e(q))},{default:t(()=>[d(" 删除 ")]),_:1},8,["icon"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["size","loading","loading-config","data","columns","pagination","onSizeChange","onCurrentChange","onSelectionChange"]),o(H,{title:e(f).id?"编辑分类":"新增分类",modelValue:e(h),"onUpdate:modelValue":n[4]||(n[4]=i=>W(h)?h.value=i:null),width:480,draggable:"","before-close":e(z)},{footer:t(()=>[o(m,{onClick:e(z)},{default:t(()=>[d("取消")]),_:1},8,["onClick"]),o(m,{type:"primary",onClick:n[3]||(n[3]=i=>e(I)(p.value))},{default:t(()=>[d(" 确定 ")]),_:1})]),default:t(()=>[o(N,{ref_key:"categoryFormRef",ref:p,model:e(f),rules:e(b),"label-width":"100px"},{default:t(()=>[o(D,{label:"分类名称",prop:"category_name"},{default:t(()=>[o(u,{modelValue:e(f).category_name,"onUpdate:modelValue":n[2]||(n[2]=i=>e(f).category_name=i),style:{width:"380px"},placeholder:"请输入分类名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","before-close"])]),_:1})}}});const Ve=de(fe,[["__scopeId","data-v-fe5e338d"]]);export{Ve as default};
